<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- wizards/budget_import_wizard_views.xml -->

    <!-- –§–æ—Ä–º–∞ –º–∞—Å—Ç–µ—Ä–∞ –∏–º–ø–æ—Ä—Ç–∞ –±—é–¥–∂–µ—Ç–æ–≤ -->
    <record id="view_budget_import_wizard_form" model="ir.ui.view">
        <field name="name">budget.import.wizard.form</field>
        <field name="model">budget.import.wizard</field>
        <field name="arch" type="xml">
            <form string="–Ü–º–ø–æ—Ä—Ç –±—é–¥–∂–µ—Ç—É –∑ Excel">
                <group>
                    <group string="–§–∞–π–ª –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É">
                        <field name="name"/>
                        <field name="import_file" widget="binary" filename="filename"/>
                        <field name="filename" invisible="1"/>
                    </group>
                    <group string="–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –±—é–¥–∂–µ—Ç—É">
                        <field name="period_id" options="{'no_create': True}"/>
                        <field name="budget_type_id" options="{'no_create': True}"/>
                        <field name="cbo_id" options="{'no_create': True}"/>
                        <field name="company_id" options="{'no_create': True}"/>
                    </group>
                </group>

                <group>
                    <group string="–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Excel">
                        <field name="sheet_name"/>
                        <field name="start_row"/>
                    </group>
                    <group string="–ú–∞–ø–ø—ñ–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫">
                        <field name="description_column"/>
                        <field name="amount_column"/>
                        <field name="quantity_column"/>
                        <field name="price_column"/>
                    </group>
                </group>

                <group>
                    <group string="–î–æ–¥–∞—Ç–∫–æ–≤—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è">
                        <field name="skip_empty_rows"/>
                        <field name="auto_create_accounts"/>
                        <field name="default_calculation_method"/>
                    </group>
                    <group string="–í–∞–ª—ñ–¥–∞—Ü—ñ—è">
                        <field name="validate_amounts"/>
                        <field name="min_amount" invisible="not validate_amounts"/>
                        <field name="max_amount" invisible="not validate_amounts"/>
                    </group>
                </group>

                <notebook>
                    <page string="–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥" invisible="not preview_data">
                        <group>
                            <field name="preview_data" widget="text" readonly="1" nolabel="1"/>
                        </group>
                    </page>
                    <page string="–†–µ–∑—É–ª—å—Ç–∞—Ç —ñ–º–ø–æ—Ä—Ç—É" invisible="not import_summary">
                        <group>
                            <field name="import_summary" widget="text" readonly="1" nolabel="1"/>
                        </group>
                    </page>
                    <page string="–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó">
                        <div class="alert alert-info">
                            <h4>–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ —ñ–º–ø–æ—Ä—Ç—É –±—é–¥–∂–µ—Ç—ñ–≤:</h4>
                            <ul>
                                <li><strong>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É:</strong> Excel (.xlsx)</li>
                                <li><strong>–°—Ç—Ä—É–∫—Ç—É—Ä–∞:</strong> –ö–æ–∂–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è –±—é–¥–∂–µ—Ç—É</li>
                                <li><strong>–û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏:</strong> –û–ø–∏—Å —Ç–∞ –°—É–º–∞</li>
                                <li><strong>–î–æ–¥–∞—Ç–∫–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏:</strong> –ö—ñ–ª—å–∫—ñ—Å—Ç—å, –¶—ñ–Ω–∞ –∑–∞ –æ–¥–∏–Ω–∏—Ü—é</li>
                            </ul>

                            <h5>–ü—Ä–∏–∫–ª–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ Excel:</h5>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>A</th><th>B (–û–ø–∏—Å)</th><th>C (–ö—ñ–ª—å–∫—ñ—Å—Ç—å)</th><th>D (–¶—ñ–Ω–∞)</th><th>E (–°—É–º–∞)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td><td>–ó–∞–ø—á–∞—Å—Ç–∏–Ω–∏ –Ω–∞ –í–¢</td><td>39.32</td><td>1250</td><td>150200</td>
                                    </tr>
                                    <tr>
                                        <td>2</td><td>–û–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º</td><td>337.5</td><td>1000</td><td>337500</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h5>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:</h5>
                            <ul>
                                <li><strong>–¢–∏–ø –±—é–¥–∂–µ—Ç—É:</strong> –ó–∞ –Ω–∞–∑–≤–æ—é —Ñ–∞–π–ª—É (–Ü–¢, –§–û–¢, –º–∞—Ä–∫–µ—Ç–∏–Ω–≥)</li>
                                <li><strong>–†–∞—Ö—É–Ω–∫–∏:</strong> –ó–∞ –∫–ª—é—á–æ–≤–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –≤ –æ–ø–∏—Å—ñ</li>
                                <li><strong>–¶–ë–û:</strong> –ó–∞ –Ω–∞–∑–≤–æ—é —Ñ–∞–π–ª—É (–£–ö, –ü–ü)</li>
                            </ul>
                        </div>
                    </page>
                </notebook>

                <footer>
                    <button name="action_preview_data"
                            string="–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥"
                            type="object"
                            class="btn-info"/>
                    <button name="action_import_budget"
                            string="–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –±—é–¥–∂–µ—Ç"
                            type="object"
                            class="btn-primary"/>
                    <button name="action_download_template"
                            string="–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —à–∞–±–ª–æ–Ω"
                            type="object"
                            class="btn-secondary"/>
                    <button string="–°–∫–∞—Å—É–≤–∞—Ç–∏"
                            class="btn-default"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action –¥–ª—è –º–∞—Å—Ç–µ—Ä–∞ –∏–º–ø–æ—Ä—Ç–∞ -->
    <record id="action_budget_import_wizard" model="ir.actions.act_window">
        <field name="name">–Ü–º–ø–æ—Ä—Ç –±—é–¥–∂–µ—Ç—É –∑ Excel</field>
        <field name="res_model">budget.import.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="view_id" ref="view_budget_import_wizard_form"/>
    </record>

    <!-- –ú–µ–Ω—é –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ -->
    <menuitem id="menu_budget_import"
              name="üìÅ –Ü–º–ø–æ—Ä—Ç –∑ Excel"
              parent="menu_budget_planning"
              action="action_budget_import_wizard"
              sequence="30"/>

    <!-- Server Action –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ -->
    <record id="action_quick_import_budget" model="ir.actions.server">
        <field name="name">–®–≤–∏–¥–∫–∏–π —ñ–º–ø–æ—Ä—Ç –±—é–¥–∂–µ—Ç—É</field>
        <field name="model_id" ref="model_budget_plan"/>
        <field name="binding_model_id" ref="model_budget_plan"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">
action = {
    'type': 'ir.actions.act_window',
    'name': '–Ü–º–ø–æ—Ä—Ç –±—é–¥–∂–µ—Ç—É –∑ Excel',
    'res_model': 'budget.import.wizard',
    'view_mode': 'form',
    'target': 'new',
}
        </field>
    </record>

</odoo>