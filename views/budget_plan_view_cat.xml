<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- views/budget_plan_views.xml - –û–ù–û–í–õ–ï–ù–ê –í–ï–†–°–Ü–Ø -->

    <!-- –û–ù–û–í–õ–ï–ù–ê –§–û–†–ú–ê –ë–Æ–î–ñ–ï–¢–ù–û–ì–û –ü–õ–ê–ù–£ -->
    <record id="view_budget_plan_form_with_categories" model="ir.ui.view">
        <field name="name">budget.plan.form.with.categories</field>
        <field name="model">budget.plan</field>
        <field name="inherit_id" ref="view_budget_plan_form"/>
        <field name="arch" type="xml">

            <!-- –î–æ–¥–∞—î–º–æ –∫–Ω–æ–ø–∫—É –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö -->
            <xpath expr="//header" position="inside">
                <button name="action_update_accounting_data"
                        string="üîÑ –û–Ω–æ–≤–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ"
                        type="object"
                        class="btn-secondary"
                        groups="account.group_account_user"
                        help="–û–Ω–æ–≤–∏—Ç–∏ —Ä–∞—Ö—É–Ω–∫–∏ –∑–≥—ñ–¥–Ω–æ –∑ –ø–æ—Ç–æ—á–Ω–∏–º–∏ –∑–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è–º–∏"/>
            </xpath>

            <!-- –ó–∞–º—ñ–Ω—é—î–º–æ notebook –∑ –ø–æ–∑–∏—Ü—ñ—è–º–∏ –±—é–¥–∂–µ—Ç—É -->
            <xpath expr="//notebook/page[@string='–ü–æ–∑–∏—Ü—ñ—ó –±—é–¥–∂–µ—Ç—É']" position="replace">
                <page string="üí∞ –ü–æ–∑–∏—Ü—ñ—ó –±—é–¥–∂–µ—Ç—É">
                    <div class="alert alert-info" role="alert">
                        <strong>–°–ø—Ä–æ—â–µ–Ω–µ –≤–≤–µ–¥–µ–Ω–Ω—è:</strong> –û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –≤–∏—Ç—Ä–∞—Ç —Ç–∞ —Ü–µ–Ω—Ç—Ä –≤–∏—Ç—Ä–∞—Ç.
                        –û–±–ª—ñ–∫–æ–≤—ñ —Ä–∞—Ö—É–Ω–∫–∏ –≤–∏–∑–Ω–∞—á–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥—ñ–¥–Ω–æ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏.
                        <button name="action_update_accounting_data" type="object"
                                class="btn btn-sm btn-outline-primary ml-2"
                                groups="account.group_account_user">
                            –û–Ω–æ–≤–∏—Ç–∏ —Ä–∞—Ö—É–Ω–∫–∏
                        </button>
                    </div>

                    <field name="line_ids"
                           context="{'default_calculation_method': 'manual'}"
                           mode="tree">
                        <tree editable="bottom" decoration-muted="is_consolidation">
                            <!-- –°–ü–†–û–©–ï–ù–Ü –ü–û–õ–Ø –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ -->
                            <field name="budget_category_id"
                                   string="üìÇ –ö–∞—Ç–µ–≥–æ—Ä—ñ—è –≤–∏—Ç—Ä–∞—Ç"
                                   options="{'no_create': True, 'no_edit': True}"
                                   required="1"/>

                            <field name="cost_center_id"
                                   string="üè¢ –¶–µ–Ω—Ç—Ä –≤–∏—Ç—Ä–∞—Ç"
                                   options="{'no_create': True, 'no_edit': True}"/>

                            <field name="description"
                                   string="üìù –û–ø–∏—Å"
                                   required="1"/>

                            <!-- –§–Ü–ù–ê–ù–°–û–í–Ü –ü–û–õ–Ø -->
                            <field name="quantity" string="–ö—ñ–ª-—Ç—å"/>
                            <field name="unit_price" string="–¶—ñ–Ω–∞"/>
                            <field name="planned_amount"
                                   string="üí∞ –ü–ª–∞–Ω–æ–≤–∞ —Å—É–º–∞"
                                   sum="–ó–∞–≥–∞–ª–æ–º"/>

                            <!-- –í–ò–ö–û–ù–ê–ù–ù–Ø -->
                            <field name="committed_amount"
                                   string="üîí –ó–∞—Ä–µ–∑–µ—Ä–≤–æ–≤–∞–Ω–æ"
                                   optional="show"/>
                            <field name="actual_amount"
                                   string="‚úÖ –§–∞–∫—Ç–∏—á–Ω–æ"
                                   optional="show"/>

                            <!-- –û–ë–õ–Ü–ö–û–í–Ü –ü–û–õ–Ø (–¥–ª—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä—ñ–≤) -->
                            <field name="account_id"
                                   string="üßæ –†–∞—Ö—É–Ω–æ–∫"
                                   optional="hide"
                                   groups="account.group_account_user"
                                   readonly="1"/>
                            <field name="analytic_account_id"
                                   string="üìä –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞"
                                   optional="hide"
                                   groups="account.group_account_user"
                                   readonly="1"/>

                            <!-- –¢–ï–•–ù–Ü–ß–ù–Ü –ü–û–õ–Ø -->
                            <field name="calculation_method" optional="hide"/>
                            <field name="is_consolidation" invisible="1"/>
                        </tree>

                        <!-- –î–ï–¢–ê–õ–¨–ù–ê –§–û–†–ú–ê –ü–û–ó–ò–¶–Ü–á -->
                        <form>
                            <sheet>
                                <group>
                                    <group string="üè∑Ô∏è –©–æ –≤–∏—Ç—Ä–∞—á–∞—î–º–æ?">
                                        <field name="budget_category_id"
                                               options="{'no_create': True}"/>
                                        <field name="cost_center_id"
                                               options="{'no_create': True}"/>
                                        <field name="description"/>
                                    </group>

                                    <group string="üí∞ –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è">
                                        <field name="quantity"/>
                                        <field name="unit_price"/>
                                        <field name="planned_amount"
                                               class="oe_inline"
                                               style="font-size: 16px; font-weight: bold;"/>
                                        <field name="calculation_method"/>
                                    </group>
                                </group>

                                <group string="üìã –û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è">
                                    <field name="calculation_basis" nolabel="1"
                                           placeholder="–Ø–∫ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–æ —Ü—é —Å—É–º—É?"/>
                                </group>

                                <notebook>
                                    <page string="üíº –í–∏–∫–æ–Ω–∞–Ω–Ω—è">
                                        <group>
                                            <group string="–í–∏—Ç—Ä–∞—á–µ–Ω–æ">
                                                <field name="committed_amount"/>
                                                <field name="actual_amount"/>
                                            </group>
                                            <group string="–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞">
                                                <field name="department_id"/>
                                                <field name="project_id"/>
                                            </group>
                                        </group>
                                    </page>

                                    <page string="üßæ –û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ"
                                          groups="account.group_account_user">
                                        <div class="alert alert-warning">
                                            <strong>–£–≤–∞–≥–∞:</strong> –¶—ñ –ø–æ–ª—è –∑–∞–ø–æ–≤–Ω—é—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
                                            –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω—å –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –∑ —Ä–∞—Ö—É–Ω–∫–∞–º–∏.
                                        </div>
                                        <group>
                                            <group string="–†–∞—Ö—É–Ω–∫–∏">
                                                <field name="account_id"
                                                       options="{'no_create': True}"/>
                                                <field name="analytic_account_id"
                                                       options="{'no_create': True}"/>
                                            </group>
                                            <group string="–ö–æ